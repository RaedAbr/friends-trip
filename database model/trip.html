<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.0 Transitional//EN'>
<html>
<head>
<title>Default Layout</title>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<!--<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>-->
<!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>-->
<link rel="shortcut icon" href="https://www.dbschema.com/images/favicon.ico">
<style type='text/css'>
body {
    font-family: 'Segoe UI', 'Lucida sans', Dialog;
    font-size: 13px;
    background-color:#f5f5f5;
    margin: 10px;
}
</style>
</head>

<body>
<object data='trip.svg' width='705' height='770' type='image/svg+xml' >
<embed src='trip.svg' width='705' height='770' type='image/svg+xml' />
<p>The <a href="http://www.adobe.com/svg/viewer/install/main.html">Adobe SVG Viewer</a> is required to view this image !</p></object>
<br/><br/>
<div class='card'><div class='card-block'><a name='event' onclick='window.scrollTo(325, 180);return false;' style='cursor:pointer;'><h4 class='card-title'>Table event</h4></a>
<table class='table-sm table-bordered'>
<thead>
<tr><th>Indexes</th><th>Field Name</th><th>Data Type</th><th>Description</th></tr></thead>
<tbody>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#pk'/></svg><svg width='14' height='14'><use xlink:href='#ref'/></svg></td>
		<td><a name='event.id'>id</a></td>
		<td> serial   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='event.name'>name</a></td>
		<td> text   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='event.date'>date</a></td>
		<td> timestamp   </td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Indexes</th></tr>
	<tr>		<td><svg width='14' height='14'><use xlink:href='#pk'/></svg></td><td>pk&#95;event</td>
		<td> ON id</td>
		<td>  </td>
	</tr>
</tbody>
</table></div></div>

<br/><br/>
<div class='card'><div class='card-block'><a name='expense' onclick='window.scrollTo(85, 150);return false;' style='cursor:pointer;'><h4 class='card-title'>Table expense</h4></a>
<table class='table-sm table-bordered'>
<thead>
<tr><th>Indexes</th><th>Field Name</th><th>Data Type</th><th>Description</th></tr></thead>
<tbody>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#unq'/></svg><svg width='14' height='14'><use xlink:href='#ref'/></svg></td>
		<td><a name='expense.id'>id</a></td>
		<td> serial   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='expense.nature'>nature</a></td>
		<td> text   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='expense.cost'>cost</a></td>
		<td> numeric&#40; 20&#44; 2 &#41;   DEFAULT 0 </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='expense.date'>date</a></td>
		<td> timestamp   DEFAULT ('now'::text)::timestamp without time zone </td>
		<td>  </td>
	</tr>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#fk'/></svg></td>
		<td><a name='expense.event_id'>event&#95;id</a></td>
		<td> integer   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#fk'/></svg></td>
		<td><a name='expense.user_login'>user&#95;login</a></td>
		<td> varchar&#40; 30 &#41;   </td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Indexes</th></tr>
	<tr>		<td><svg width='14' height='14'><use xlink:href='#unq'/></svg></td><td>pk&#95;expense</td>
		<td> ON id</td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Foreign Keys</th></tr>
	<tr>
		<td><svg width='14' height='14'><use xlink:href='#fk'/></svg></td><td>ref_event_id</td>
		<td > ( event&#95;id ) ref <a href='#event'>event</a> (id) </td>
		<td>  </td>
	</tr>
	<tr>
		<td><svg width='14' height='14'><use xlink:href='#fk'/></svg></td><td>ref_user_login</td>
		<td > ( user&#95;login ) ref <a href='#user'>user</a> (login) </td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Constraints</th></tr>
	<tr>
		<td>&nbsp;</td><td> expense_cost_check </td><td> cost &gt;&#61; &#40;0&#41;&#58;&#58;numeric </td><td> </td>
	</tr>
</tbody>
</table></div></div>

<br/><br/>
<div class='card'><div class='card-block'><a name='expense_concerned' onclick='window.scrollTo(85, 375);return false;' style='cursor:pointer;'><h4 class='card-title'>Table expense_concerned</h4></a>
<table class='table-sm table-bordered'>
<thead>
<tr><th>Indexes</th><th>Field Name</th><th>Data Type</th><th>Description</th></tr></thead>
<tbody>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#pk'/></svg><svg width='14' height='14'><use xlink:href='#fk'/></svg></td>
		<td><a name='expense_concerned.expense_id'>expense&#95;id</a></td>
		<td> integer   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#pk'/></svg><svg width='14' height='14'><use xlink:href='#fk'/></svg></td>
		<td><a name='expense_concerned.concerned'>concerned</a></td>
		<td> varchar&#40; 30 &#41;   </td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Indexes</th></tr>
	<tr>		<td><svg width='14' height='14'><use xlink:href='#pk'/></svg></td><td>pk&#95;expense&#95;concerned</td>
		<td> ON expense&#95;id&#44; concerned</td>
		<td>  </td>
	</tr>
	<tr>		<td><svg width='14' height='14'><use xlink:href='#idx'/></svg></td><td>idx&#95;expense&#95;concerned</td>
		<td> ON expense&#95;id</td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Foreign Keys</th></tr>
	<tr>
		<td><svg width='14' height='14'><use xlink:href='#fk'/></svg></td><td>ref_user_login</td>
		<td > ( concerned ) ref <a href='#user'>user</a> (login) </td>
		<td>  </td>
	</tr>
	<tr>
		<td><svg width='14' height='14'><use xlink:href='#fk'/></svg></td><td>fk_expense_concerned_expense</td>
		<td > ( expense&#95;id ) ref <a href='#expense'>expense</a> (id) </td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Triggers</th></tr>
	<tr>
		<td>&nbsp;</td><td> before_insert_expense_concerned_trigger </td><td>  </td><td> </td>
	</tr>
</tbody>
</table></div></div>

<br/><br/>
<div class='card'><div class='card-block'><a name='user' onclick='window.scrollTo(60, 180);return false;' style='cursor:pointer;'><h4 class='card-title'>Table user</h4></a>
<table class='table-sm table-bordered'>
<thead>
<tr><th>Indexes</th><th>Field Name</th><th>Data Type</th><th>Description</th></tr></thead>
<tbody>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#pk'/></svg><svg width='14' height='14'><use xlink:href='#ref'/></svg></td>
		<td><a name='user.login'>login</a></td>
		<td> varchar&#40; 30 &#41;   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='user.password'>password</a></td>
		<td> varchar&#40; 30 &#41;   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='user.email'>email</a></td>
		<td> varchar&#40; 50 &#41;   </td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Indexes</th></tr>
	<tr>		<td><svg width='14' height='14'><use xlink:href='#pk'/></svg></td><td>pk&#95;user</td>
		<td> ON login</td>
		<td>  </td>
	</tr>
</tbody>
</table></div></div>

<br/><br/>
<div class='card'><div class='card-block'><a name='user_event' onclick='window.scrollTo(85, 45);return false;' style='cursor:pointer;'><h4 class='card-title'>Table user_event</h4></a>
<table class='table-sm table-bordered'>
<thead>
<tr><th>Indexes</th><th>Field Name</th><th>Data Type</th><th>Description</th></tr></thead>
<tbody>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#pk'/></svg><svg width='14' height='14'><use xlink:href='#fk'/></svg></td>
		<td><a name='user_event.event_id'>event&#95;id</a></td>
		<td> integer   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>*<svg width='14' height='14'><use xlink:href='#pk'/></svg><svg width='14' height='14'><use xlink:href='#fk'/></svg></td>
		<td><a name='user_event.user_login'>user&#95;login</a></td>
		<td> varchar&#40; 30 &#41;   </td>
		<td>  </td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td><a name='user_event.user_weight'>user&#95;weight</a></td>
		<td> integer   DEFAULT 1 </td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Indexes</th></tr>
	<tr>		<td><svg width='14' height='14'><use xlink:href='#pk'/></svg></td><td>pk&#95;user&#95;event</td>
		<td> ON event&#95;id&#44; user&#95;login</td>
		<td>  </td>
	</tr>
<tr><th colspan='4'>Foreign Keys</th></tr>
	<tr>
		<td><svg width='14' height='14'><use xlink:href='#fk'/></svg></td><td>ref_event_id</td>
		<td > ( event&#95;id ) ref <a href='#event'>event</a> (id) </td>
		<td>  </td>
	</tr>
	<tr>
		<td><svg width='14' height='14'><use xlink:href='#fk'/></svg></td><td>ref_user_login</td>
		<td > ( user&#95;login ) ref <a href='#user'>user</a> (login) </td>
		<td>  </td>
	</tr>
</tbody>
</table></div></div>

<br/><br/>
<div class='card'><div class='card-block'><a name='concerned_users_by_expenses' onclick='window.scrollTo(60, 495);return false;' style='cursor:pointer;'><h2>View concerned_users_by_expenses</h2></a>
<table class='table-sm table-bordered'>
<thead>
	<tr>
		<th><a name='concerned_users_by_expenses'>Query</a></th></tr>
</thead>
<tbody>
	<tr><td> SELECT e&#46;event&#95;id&#44;
    ec&#46;concerned AS user&#95;login&#44;
    e&#46;user&#95;login AS pay&#95;to&#95;user&#44;
    e&#46;cost&#44;
    ec&#46;expense&#95;id
   FROM &#40;trip&#46;expense&#95;concerned ec
     JOIN trip&#46;expense e ON &#40;&#40;e&#46;id &#61; ec&#46;expense&#95;id&#41;&#41;&#41;&#59;</td></tr>
</tbody>
</table></div></div>
<br/><br/>
<div class='card'><div class='card-block'><a name='group_balance' onclick='window.scrollTo(265, 495);return false;' style='cursor:pointer;'><h2>View group_balance</h2></a>
<table class='table-sm table-bordered'>
<thead>
	<tr>
		<th><a name='group_balance'>Query</a></th></tr>
</thead>
<tbody>
	<tr><td> SELECT expense&#46;user&#95;login&#44;
    expense&#46;event&#95;id&#44;
    sum&#40;expense&#46;cost&#41; AS sum
   FROM trip&#46;expense
  GROUP BY expense&#46;user&#95;login&#44; expense&#46;event&#95;id&#59;</td></tr>
</tbody>
</table></div></div>
<br/><br/>
<div class='card'><div class='card-block'><a name='parts_of_expense' onclick='window.scrollTo(70, 495);return false;' style='cursor:pointer;'><h2>View parts_of_expense</h2></a>
<table class='table-sm table-bordered'>
<thead>
	<tr>
		<th><a name='parts_of_expense'>Query</a></th></tr>
</thead>
<tbody>
	<tr><td> SELECT r&#46;expense&#95;id&#44;
    sum&#40;r&#46;user&#95;weight&#41; AS parts&#95;nb
   FROM &#40; SELECT res&#46;expense&#95;id&#44;
            res&#46;concerned&#44;
            u&#46;event&#95;id&#44;
            u&#46;user&#95;weight
           FROM &#40;&#40; SELECT ec&#46;expense&#95;id&#44;
                    ec&#46;concerned&#44;
                    e&#46;event&#95;id
                   FROM &#40;trip&#46;expense&#95;concerned ec
                     JOIN trip&#46;expense e ON &#40;&#40;e&#46;id &#61; ec&#46;expense&#95;id&#41;&#41;&#41;&#41; res
             JOIN trip&#46;user&#95;event u ON &#40;&#40;res&#46;event&#95;id &#61; u&#46;event&#95;id&#41;&#41;&#41;
          WHERE &#40;&#40;res&#46;concerned&#41;&#58;&#58;text &#61; &#40;u&#46;user&#95;login&#41;&#58;&#58;text&#41;&#41; r
  GROUP BY r&#46;expense&#95;id&#44; r&#46;event&#95;id&#59;</td></tr>
</tbody>
</table></div></div>
<p align='right'><a href='https://www.dbschema.com' style='color:#aaa'>Powered by DbSchema</a></p></body></html>